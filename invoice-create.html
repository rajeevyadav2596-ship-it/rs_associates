<!DOCTYPE html>
<html>
<head>
<title>RS Associates Invoice</title>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<style>
body{
  font-family:Arial;
  background:#eef2f7;
  padding:30px;
}
.container{
  background:#fff;
  padding:25px;
  border-radius:12px;
  max-width:700px;
  margin:auto;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
}
input,select{
  width:100%;
  padding:10px;
  margin-top:8px;
  margin-bottom:15px;
  border:1px solid #ccc;
  border-radius:6px;
}
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:6px;
  background:#2d4a8a;
  color:#fff;
  font-weight:bold;
  margin-top:10px;
  cursor:pointer;
}

/* Invoice Design */

.invoiceBox{
  width:800px;
  background:#fff;
  padding:30px;
  margin-top:30px;
  border-radius:12px;
  box-shadow:0 0 10px rgba(0,0,0,0.15);
}
.header{
  display:flex;
  justify-content:space-between;
  border-bottom:2px solid #2d4a8a;
  padding-bottom:10px;
  margin-bottom:20px;
}
.title{
  font-size:26px;
  font-weight:bold;
  color:#2d4a8a;
}
table{
  width:100%;
  border-collapse:collapse;
}
td,th{
  padding:10px;
  border-bottom:1px solid #ddd;
}
.total{
  font-size:20px;
  font-weight:bold;
}
</style>
</head>
<body>

<div class="container">

<h2>RS Associates — Invoice</h2>

<select id="firmSelect" onchange="loadCustomer()"></select>

<input id="person" placeholder="Person Name">

<input id="invoiceNo" placeholder="Invoice No">

<input id="gstFee" placeholder="GST Fee">
<input id="auditFee" placeholder="Audit Fee">
<input id="itrFee" placeholder="ITR Fee">

<h4>Other Expenses</h4>

<input id="other1Name" placeholder="Expense Header">
<input id="other1Amt" placeholder="Amount">

<input id="other2Name" placeholder="Expense Header">
<input id="other2Amt" placeholder="Amount">

<button onclick="generateInvoice()">Generate Invoice</button>
<button onclick="downloadJPG()">Copy Invoice JPG</button>

</div>

<!-- INVOICE JPG AREA -->

<div id="invoice" class="invoiceBox">

<div class="header">
<div>
<div class="title">RS Associates</div>
<div>Professional Services</div>
</div>

<div>
<div><b>Invoice No:</b> <span id="invNo"></span></div>
<div><b>Date:</b> <span id="invDate"></span></div>
</div>
</div>

<div>
<b>Client:</b> <span id="clientName"></span><br>
<b>Person:</b> <span id="clientPerson"></span>
</div>

<br>

<table>
<thead>
<tr>
<th>Particular</th>
<th>Amount ₹</th>
</tr>
</thead>

<tbody id="billBody"></tbody>

<tfoot>
<tr>
<td>GST 18%</td>
<td id="gstAmt"></td>
</tr>

<tr class="total">
<td>Total</td>
<td id="grandTotal"></td>
</tr>
</tfoot>
</table>

</div>

<script>

let customers=JSON.parse(localStorage.getItem("customers")||"[]");

customers.forEach((c,i)=>{
  firmSelect.innerHTML+=
  `<option value="${i}">
   ${c.firm} - ${c.person}
   </option>`;
});

function loadCustomer(){
  let c=customers[firmSelect.value];
  person.value=c.person;
  gstFee.value=c.gst;
  auditFee.value=c.audit;
  itrFee.value=c.itr;
}
loadCustomer();

function generateInvoice(){

let gst=+gstFee.value||0;
let audit=+auditFee.value||0;
let itr=+itrFee.value||0;
let o1=+other1Amt.value||0;
let o2=+other2Amt.value||0;

let subtotal=gst+audit+itr+o1+o2;
let gstCalc=subtotal*0.18;
let total=subtotal+gstCalc;

invNo.innerText=invoiceNo.value;
invDate.innerText=new Date().toLocaleDateString();

clientName.innerText=
firmSelect.options[firmSelect.selectedIndex].text;

clientPerson.innerText=person.value;

billBody.innerHTML=`
<tr><td>GST Filing Fees</td><td>${gst}</td></tr>
<tr><td>Audit Fees</td><td>${audit}</td></tr>
<tr><td>ITR Filing</td><td>${itr}</td></tr>
<tr><td>${other1Name.value}</td><td>${o1}</td></tr>
<tr><td>${other2Name.value}</td><td>${o2}</td></tr>
`;

gstAmt.innerText="₹ "+gstCalc.toFixed(2);
grandTotal.innerText="₹ "+total.toFixed(2);
}

function downloadJPG(){

html2canvas(document.getElementById("invoice"))
.then(canvas=>{
  let link=document.createElement("a");
  link.download="Invoice.jpg";
  link.href=canvas.toDataURL();
  link.click();

  // AUTO OPEN
  window.open(link.href);
});
}
</script>

</body>
</html>
