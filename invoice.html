<!DOCTYPE html>
<html>
<head>
<title>Invoice</title>

<style>
body{
font-family:Calibri;
background:#eef2f7;
padding:40px;
}

.card{
background:white;
padding:30px;
border-radius:10px;
width:900px;
margin:auto;
}

table{
width:100%;
border-collapse:collapse;
}

td{
padding:8px;
}

input,select{
width:100%;
padding:8px;
border:1px solid #ccc;
border-radius:4px;
}

.heading{
font-size:22px;
font-weight:bold;
margin-bottom:20px;
}

.total{
font-size:18px;
font-weight:bold;
}
</style>
</head>

<body>

<div class="card">

<div class="heading">
RS Associates â€“ Invoice
</div>

<table>

<tr>
<td>Customer Name</td>
<td>
<input id="firm" list="firmList">
<datalist id="firmList"></datalist>
</td>
</tr>

<tr>
<td>Person Name</td>
<td><input id="person"></td>
</tr>

<tr>
<td><b>Invoice No.</b></td>
<td><input id="invoiceNo" readonly></td>
</tr>

<tr>
<td><b>Time Period</b></td>
<td>
<input type="month" id="from">
to
<input type="month" id="to">
</td>
</tr>

<tr>
<td>GST Fees (Per Month)</td>
<td><input id="gst"></td>
</tr>

<tr>
<td>GST Charges</td>
<td id="gstAuto">Auto Calculated</td>
</tr>

<tr>
<td>Audit Charges</td>
<td><input id="audit"></td>
</tr>

<tr>
<td>Other Charges / TDS</td>
<td><input id="other"></td>
</tr>

<tr>
<td>ITR</td>
<td><input id="itr"></td>
</tr>

<tr>
<td>Define Charges</td>
<td><input></td>
</tr>

<tr>
<td>Define Charges</td>
<td><input></td>
</tr>

<tr>
<td class="total">Final Bill</td>
<td class="total" id="finalBill"></td>
</tr>

</table>

<button onclick="generate()">Generate</button>

</div>



<script>

const API=
"https://backend.rajeevyadav2596.workers.dev";


/* AUTO INVOICE NO */

fetch(API+"/api/next-invoice")
.then(r=>r.json())
.then(d=>invoiceNo.value=d.no);


/* LOAD FIRMS */

fetch(API+"/api/firms")
.then(r=>r.json())
.then(d=>{
d.forEach(f=>{
firmList.innerHTML+=
`<option value="${f.firm_name}">`;
});
});


/* GST AUTO CALC */

function generate(){

let months=
(new Date(to.value).getMonth() -
new Date(from.value).getMonth())
+1;

let gstTotal=
months * (+gst.value||0);

gstAuto.innerHTML=
gstTotal+" (Auto)";

let total=
gstTotal+
(+audit.value||0)+
(+other.value||0)+
(+itr.value||0);

finalBill.innerHTML=total;


/* SAVE NEW FIRM */

fetch(API+"/api/add-firm",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
firm:firm.value,
person:person.value,
gst:gst.value
})
});

}
</script>

</body>
</html>
