<script>
const API = "https://ledger-api.YOURNAME.workers.dev";

async function saveEntry(){

let firm = document.getElementById("firmName").value.trim();
let rate = Number(document.getElementById("rate").value);
let fees = Number(document.getElementById("fees").value);
let payment = Number(document.getElementById("payment").value);
let discount = Number(document.getElementById("discount").value);
let type = document.getElementById("paymentType").value;

if(!firm || !type){
  alert("Firm Name & Payment Type mandatory");
  return;
}

let balance = fees - payment - discount;

await fetch(API,{
method:"POST",
headers:{ "Content-Type":"application/json" },
body:JSON.stringify({
firm,
date:new Date().toLocaleString(),
rate,
fees,
payment,
discount,
balance,
payment_type:type
})
});

alert("Saved Online");
}


async function loadLedger(){

let firm = document.getElementById("searchFirm").value;

let res = await fetch(API+"?firm="+firm);
let data = await res.json();

let html="";

data.forEach(e=>{
html+=`
<tr>
<td>${e.date}</td>
<td>${e.rate}</td>
<td>${e.fees}</td>
<td>${e.payment}</td>
<td>${e.discount}</td>
<td>${e.balance}</td>
<td>${e.payment_type}</td>
</tr>`;
});

document.getElementById("ledgerTable").innerHTML=html;
}
</script>
