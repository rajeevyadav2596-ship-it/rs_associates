<!DOCTYPE html>
<html>
<head>
<title>RS Associates – Firm Ledger</title>

<style>

body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f4f6f9;
  padding:20px;
}

/* Card Layout */

.card{
  background:#ffffff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 2px 8px rgba(0,0,0,0.08);
  margin-bottom:20px;
}

h2{
  margin-top:0;
  color:#2c3e50;
}

/* Inputs */

input, select{
  padding:10px;
  margin:6px 0;
  width:260px;
  border:1px solid #ccc;
  border-radius:6px;
}

/* Button */

button{
  background:#2e86de;
  color:white;
  padding:10px 18px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

button:hover{
  background:#1b4f72;
}

/* Table */

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
  background:white;
}

th{
  background:#2e86de;
  color:white;
  padding:10px;
  text-align:left;
}

td{
  padding:8px;
  border-bottom:1px solid #ddd;
}

tr:hover{
  background:#f2f2f2;
}

.header{
  font-size:22px;
  font-weight:bold;
  margin-bottom:15px;
  color:#1b4f72;
}

</style>
</head>

<body>

<div class="header">
RS Associates – Ledger System
</div>


<!-- =========================
     ADD ENTRY
========================= -->

<div class="card">

<h2>Add Ledger Entry</h2>

<input list="firmList"
id="firmName"
placeholder="Firm Name">

<datalist id="firmList"></datalist><br>


<input type="number"
id="rate"
placeholder="Rate"><br>


<input type="number"
id="fees"
placeholder="Fees / Charges"><br>


<input type="number"
id="payment"
placeholder="Payment"><br>


<input type="number"
id="discount"
placeholder="Discount"><br>


<select id="paymentType" required>
<option value="">Payment Type *</option>
<option>Cash</option>
<option>Credit</option>
</select><br><br>


<button onclick="saveEntry()">
Save Entry
</button>

</div>



<!-- =========================
     DASHBOARD
========================= -->

<div class="card">

<h2>Ledger Dashboard</h2>

<input id="searchFirm"
placeholder="Firm Name">

<button onclick="loadLedger()">
Load Ledger
</button>


<table>

<thead>
<tr>
<th>Date</th>
<th>Rate</th>
<th>Fees</th>
<th>Payment</th>
<th>Discount</th>
<th>Balance</th>
<th>Payment Type</th>
</tr>
</thead>

<tbody id="ledgerTable"></tbody>

</table>

</div>



<script>

/* =========================
   API URL (YOUR WORKER)
========================= */

const API =
"https://backend.rajeevyadav2596.workers.dev";



/* =========================
   SAVE ENTRY
========================= */

async function saveEntry(){

let firm =
document.getElementById("firmName").value.trim();

let rate =
document.getElementById("rate").value || 0;

let fees =
document.getElementById("fees").value || 0;

let payment =
document.getElementById("payment").value || 0;

let discount =
document.getElementById("discount").value || 0;

let type =
document.getElementById("paymentType").value;


/* Mandatory check */

if(!firm || !type){
alert("Firm Name & Payment Type required");
return;
}


/* API POST */

await fetch(
API + "/api/add-ledger",
{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
firm,
rate,
fees,
payment,
discount,
payment_type:type
})
}
);

alert("Saved Successfully");


/* Save firm in dropdown memory */

let firms =
JSON.parse(localStorage.getItem("firms")) || [];

if(!firms.includes(firm)){
firms.push(firm);
localStorage.setItem(
"firms",
JSON.stringify(firms)
);
loadFirmDropdown();
}

}



/* =========================
   LOAD LEDGER
========================= */

async function loadLedger(){

let firm =
document.getElementById("searchFirm").value;

if(!firm){
alert("Enter firm name");
return;
}

let res =
await fetch(
API + "/api/get-ledger?firm=" + firm
);

let data = await res.json();

let html="";

data.forEach(e=>{

html += `
<tr>
<td>${e.date}</td>
<td>${e.rate}</td>
<td>${e.fees}</td>
<td>${e.payment}</td>
<td>${e.discount}</td>
<td>${e.balance}</td>
<td>${e.payment_type}</td>
</tr>
`;

});

document.getElementById(
"ledgerTable"
).innerHTML = html;

}



/* =========================
   FIRM DROPDOWN MEMORY
========================= */

function loadFirmDropdown(){

let firms =
JSON.parse(localStorage.getItem("firms")) || [];

let list =
document.getElementById("firmList");

list.innerHTML="";

firms.forEach(f=>{
list.innerHTML +=
`<option value="${f}">`;
});

}

loadFirmDropdown();

</script>

</body>
</html>
